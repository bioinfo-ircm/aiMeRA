rownames(xind)[4]=i
res=tryCatch(mra(hyb,xind,check=F),error=function(e)e)
if(any(class(res)=="error")|is.null(res))
next()
rpa=diag(res$local_matrix)
rpa[3:4]=0
aux=solve(res$link_matrix,-rpa)
a=(-res$glb*((aux+2)/(aux-2)))
b=hyb[rownames(res$link_matrix),cond]
pred[i]=round(a[4])
err_rel[i]=abs(a[4]-b[4])/b[4]
}
err_rel1=sort(err_rel,decreasing = F)
err_rel1
res
cond="E2+siLCoR+siRIP140"
cond_all_E2=c("Et",cond,"E2+siRIP140","E2+siLCoR","E2")
pred=vector()
err_rel=vector()
for(i in genes)
{
if(sum(hyb[i,colnames(xind)])<=length(cond_all_E2)*10)
{
print(i)
next()
}
rownames(xind)[4]=i
res=tryCatch(mra(hyb,xind,check=F),error=function(e)e)
if(any(class(res)=="error")|is.null(res))
next()
rpa=diag(res$local_matrix)
rpa[3:4]=0
aux=solve(res$link_matrix,-rpa)
a=(-res$glb*((aux+2)/(aux-2)))
b=hyb[rownames(res$link_matrix),cond]
pred[i]=round(a[4])
err_rel[i]=abs(a[4]-b[4])/b[4]
}
genes
res
err_rel1
data="C:/Users/gabriel.jimenez/Dropbox/estrogen_receptors/mra/table_moyenne.csv"
xqpcr=as.matrix(read.table(data,sep=";",header = T,check.names = F,row.names = 1))
xqpcr=xqpcr[-9,]
x1=as.matrix(read.table("C:/Users/gabriel.jimenez/Dropbox/estrogen_receptors/mra/rnaseq_transA.csv",sep="\t",header = T,check.names = F,row.names = 1))
x2=as.matrix(read.table("C:/Users/gabriel.jimenez/Dropbox/estrogen_receptors/mra/rnaseq_transB.csv",sep="\t",header = T,check.names = F,row.names = 1))
xrnaseq=(x2+x1)/2
hyb=rbind(xqpcr,xrnaseq)
lb="E2"
chip=read.table("C:/Users/gabriel.jimenez/Dropbox/estrogen_receptors/mra//activity_reporters/E2-cross-chipseq-full.txt",header = F,sep = "\t",stringsAsFactors = F)$V1
xind=read.rules(c("E2+siLCoR->LCoR","E2+siRIP140->RIP140","Et->{Luc}ERa","E2->0","0->bid"))
genes_E2=read.table("C:/Users/gabriel.jimenez/Dropbox/estrogen_receptors/mra//activity_reporters/gene-selection-E2-Et.txt",sep="\t",header = T,stringsAsFactors = F)
genes_RIP=read.table("C:/Users/gabriel.jimenez/Dropbox/estrogen_receptors/mra//activity_reporters/gene-selection-RIP140-E2.txt",sep="\t",header = T,stringsAsFactors = F)
genes_LCOR=read.table("C:/Users/gabriel.jimenez/Dropbox/estrogen_receptors/mra//activity_reporters/gene-selection-LCoR-E2.txt",sep="\t",header = T,stringsAsFactors = F)
genes_LCOR_RIP=unique(c(genes_LCOR$genes,genes_RIP$genes))
genes=genes_E2[genes_E2$genes%in%genes_LCOR_RIP,"genes"]
genes=genes[genes%in%chip]
cond="E2+siLCoR+siRIP140"
cond_all_E2=c("Et",cond,"E2+siRIP140","E2+siLCoR","E2")
pred=vector()
err_rel=vector()
for(i in genes)
{
if(sum(hyb[i,colnames(xind)])<=length(cond_all_E2)*10)
{
print(i)
next()
}
rownames(xind)[4]=i
res=tryCatch(mra(hyb,xind,check=F),error=function(e)e)
if(any(class(res)=="error")|is.null(res))
next()
rpa=diag(res$local_matrix)
aux=solve(res$link_matrix,-rpa*c(0.4,1,0,0))
a=(-res$glb*((aux+2)/(aux-2)))
b=hyb[rownames(res$link_matrix),cond]
pred[i]=round(a[4])
err_rel[i]=abs(a[4]-b[4])/b[4]
}
err_rel2=sort(err_rel,decreasing = F)
sum(err_rel1>err_rel2[names(err_rel1)])
err_rel1
err_rel2[names(err_rel1)]
pred[names(err_rel1)]
hyb[names(err_rel1),cond]
a1=apply(xrnaseq[names(pred),c("E2+siRIP140","E2+siLCoR")],1,mean)
a2=apply(xrnaseq[names(pred),c("E2+siRIP140","E2+siLCoR")],1,geometric.mean)
a3=pmax(xrnaseq[names(pred),"E2+siRIP140"],xrnaseq[names(pred),"E2+siLCoR"])
a4=(xrnaseq[names(pred),"E2+siRIP140"]*xrnaseq[names(pred),"E2+siLCoR"])
b=xrnaseq[names(pred),cond]
write.table(data.frame(MRA_alpha_beta=err_rel2[names(err_rel1)],
file="./activity_reporters/Error_predictions_table3.txt",quote = F,sep="\t",row.names = F))
write.table(data.frame(MRA_alpha_beta=err_rel2[names(err_rel1)],file="./activity_reporters/Error_predictions_table3.txt",quote = F,sep="\t"))
write.table(data.frame(MRA_alpha_beta=err_rel2[names(err_rel1)]),file="./activity_reporters/Error_predictions_table3.txt",quote = F,sep="\t")
write.table(data.frame(MRA_alpha_beta=err_rel2[names(err_rel1)]),file="C:/Users/gabriel.jimenez/Dropbox/estrogen_receptors/Publi/Error_predictions_table3.txt",quote = F,sep="\t")
sum(err_rel1>err_rel2[names(err_rel1)])
sum(err_rel2[names(err_rel1)]<err_rel1)
############RIP140#############
pdf("C:/Users/gabriel.jimenez/Dropbox/estrogen_receptors/Publi/barplot_A1_85x85.pdf",width=3.35,height=3.35,useDingbats=T,pointsize=7)
toto = barplot(data$mean[2,c(1,9)],ylab="RIP140 mRNA expression (%)",names=c("siCtl","siRIP140"),cex.lab=1,cex.names=1, col="black",space=1,
ylim = c(0,120),xlim = c(0, 1), width = 0.1)
moyenne_liste=c(data$mean[2,1],data$mean[2,9])
#############################Barplot siRNAS#################################
library(data.table)
#data=data.setup(list(estr1_A,estr1_B,estr2_A,estr2_B,estr3_A,estr3_B))
data1=fread("C:/Users/gabriel.jimenez/Dropbox/estrogen_receptors/mra/table_%.csv",data.table=F)
rownames(data1)=data1$V1
data1=data1[,-1]
data1=list(trans1.a=data1[,1:16],trans2.a=data1[,17:32],trans3.a=data1[,33:48])
data2=fread("C:/Users/gabriel.jimenez/Dropbox/estrogen_receptors/mra/table_%_rep.csv",data.table=F)
rownames(data2)=data2$V1
data2=data2[,-1]
data2=list(trans1.b=data2[,1:16],trans2.b=data2[,17:32],trans3.b=data2[,33:48])
all.data=c(data1,data2)
data=data2sdmean(all.data)
#data=lapply(data, function(x)x/x[,"Et"]*100)
#data=data2sdmean(data)
#A function to add arrows on the chart
error.bar <- function(x, y, upper, lower=upper, length=0.1,...){
arrows(x,y+upper, x, y-lower, angle=90, code=3, length=length, ...)
}
int.ech = function(vector,conf.level=0.95,na.rm=T)
{ # VERSION 2016
if (length(vector)==0) { cat("Erreur ! Le vecteur ",substitute(vector),"est vide.\n")}
else { s = var(vector,na.rm=na.rm)
n = length(vector)-sum(is.na(vector))
ddl = n - 1 ; proba = (1-conf.level)*100 ; proba = (100-proba/2)/100
t_student = qt(proba, ddl) # quantile
intervalle = t_student * sqrt(s/n)
moyenne = mean(vector,na.rm=na.rm)
return(intervalle) }}
############RIP140#############
pdf("C:/Users/gabriel.jimenez/Dropbox/estrogen_receptors/Publi/barplot_A1_85x85.pdf",width=3.35,height=3.35,useDingbats=T,pointsize=7)
toto = barplot(data$mean[2,c(1,9)],ylab="RIP140 mRNA expression (%)",names=c("siCtl","siRIP140"),cex.lab=1,cex.names=1, col="black",space=1,
ylim = c(0,120),xlim = c(0, 1), width = 0.1)
moyenne_liste=c(data$mean[2,1],data$mean[2,9])
int.siCTR=int.ech(sapply(all.data,function(x)x[2,1]),0.95)
int.siRIP=int.ech(sapply(all.data,function(x)x[2,9]),0.95)
int_liste = c(int.siCTR,int.siRIP)
arrows(toto,moyenne_liste-int_liste,toto, moyenne_liste+int_liste, lwd=2, angle=90,length=0.1,code=3)
#asteriks
test_add1 = t.test(sapply(all.data,function(x)x[2,1]),sapply(all.data,function(x)x[2,9]), var.equal=TRUE)
test_add1$p.value
text(toto,moyenne_liste+10,c("","**"),cex=2)
#box(xlim=c(0,1))
#error.bar(toto,data$mean[2,c(1,9)],data$sd[2,c(1,9)])
dev.off()
#box(xlim=c(0,1))
#error.bar(toto,data$mean[2,c(1,9)],data$sd[2,c(1,9)])
dev.off()
############RIP140#############
pdf("C:/Users/gabriel.jimenez/Dropbox/estrogen_receptors/Publi/barplot_A1_85x85.pdf",width=3.35,height=3.35,useDingbats=T,pointsize=7)
toto = barplot(data$mean[2,c(1,9)],ylab="RIP140 mRNA expression (%)",names=c("siCtl","siRIP140"),cex.lab=1,cex.names=1, col="black",space=1,
ylim = c(0,120),xlim = c(0, 1), width = 0.1)
moyenne_liste=c(data$mean[2,1],data$mean[2,9])
int.siCTR=int.ech(sapply(all.data,function(x)x[2,1]),0.95)
int.siRIP=int.ech(sapply(all.data,function(x)x[2,9]),0.95)
int_liste = c(int.siCTR,int.siRIP)
arrows(toto,moyenne_liste-int_liste,toto, moyenne_liste+int_liste, lwd=2, angle=90,length=0.1,code=3)
#asteriks
test_add1 = t.test(sapply(all.data,function(x)x[2,1]),sapply(all.data,function(x)x[2,9]), var.equal=TRUE)
test_add1$p.value
text(toto,moyenne_liste+10,c("","**"),cex=2)
#box(xlim=c(0,1))
#error.bar(toto,data$mean[2,c(1,9)],data$sd[2,c(1,9)])
dev.off()
#box(xlim=c(0,1))
#error.bar(toto,data$mean[2,c(1,9)],data$sd[2,c(1,9)])
dev.off()
#box(xlim=c(0,1))
#error.bar(toto,data$mean[2,c(1,9)],data$sd[2,c(1,9)])
dev.off()
############RIP140#############
pdf("C:/Users/gabriel.jimenez/Dropbox/estrogen_receptors/Publi/barplot_A1_85x85.pdf",width=3.35,height=3.35,useDingbats=T,pointsize=7)
toto = barplot(data$mean[2,c(1,9)],ylab="RIP140 mRNA expression (%)",names=c("siCtl","siRIP140"),cex.lab=1,cex.names=1, col="black",space=1,
ylim = c(0,120),xlim = c(0, 1), width = 0.1)
moyenne_liste=c(data$mean[2,1],data$mean[2,9])
int.siCTR=int.ech(sapply(all.data,function(x)x[2,1]),0.95)
int.siRIP=int.ech(sapply(all.data,function(x)x[2,9]),0.95)
int_liste = c(int.siCTR,int.siRIP)
arrows(toto,moyenne_liste-int_liste,toto, moyenne_liste+int_liste, lwd=2, angle=90,length=0.1,code=3)
#asteriks
test_add1 = t.test(sapply(all.data,function(x)x[2,1]),sapply(all.data,function(x)x[2,9]), var.equal=TRUE)
text(toto,moyenne_liste+10,c("","**"),cex=2)
#box(xlim=c(0,1))
#error.bar(toto,data$mean[2,c(1,9)],data$sd[2,c(1,9)])
dev.off()
toto = barplot(data$mean[2,c(1,9)],ylab="RIP140 mRNA expression (%)",names=c("siCtl","siRIP140"),cex.lab=1,cex.names=1, col="black",space=1,
ylim = c(0,120),xlim = c(0, 1), width = 0.1)
moyenne_liste=c(data$mean[2,1],data$mean[2,9])
int.siCTR=int.ech(sapply(all.data,function(x)x[2,1]),0.95)
int.siRIP=int.ech(sapply(all.data,function(x)x[2,9]),0.95)
int_liste = c(int.siCTR,int.siRIP)
arrows(toto,moyenne_liste-int_liste,toto, moyenne_liste+int_liste, lwd=2, angle=90,length=0.1,code=3)
toto = barplot(data$mean[2,c(1,9)],ylab="RIP140 mRNA expression (%)",names=c("siCtl","siRIP140"),cex.lab=1,cex.names=1, col="black",space=1,
ylim = c(0,120),xlim = c(0, 1), width = 0.1)
moyenne_liste=c(data$mean[2,1],data$mean[2,9])
int.siCTR=int.ech(sapply(all.data,function(x)x[2,1]),0.95)
int.siRIP=int.ech(sapply(all.data,function(x)x[2,9]),0.95)
int_liste = c(int.siCTR,int.siRIP)
arrows(toto,moyenne_liste-int_liste,toto, moyenne_liste+int_liste, lwd=1, angle=90,length=0.1,code=3)
############RIP140#############
pdf("C:/Users/gabriel.jimenez/Dropbox/estrogen_receptors/Publi/barplot_A1_85x85.pdf",width=3.35,height=3.35,useDingbats=T,pointsize=7)
toto = barplot(data$mean[2,c(1,9)],ylab="RIP140 mRNA expression (%)",names=c("siCtl","siRIP140"),cex.lab=1,cex.names=1, col="black",space=1,
ylim = c(0,120),xlim = c(0, 1), width = 0.1)
moyenne_liste=c(data$mean[2,1],data$mean[2,9])
int.siCTR=int.ech(sapply(all.data,function(x)x[2,1]),0.95)
int.siRIP=int.ech(sapply(all.data,function(x)x[2,9]),0.95)
int_liste = c(int.siCTR,int.siRIP)
arrows(toto,moyenne_liste-int_liste,toto, moyenne_liste+int_liste, lwd=1, angle=90,length=0.1,code=3)
#asteriks
test_add1 = t.test(sapply(all.data,function(x)x[2,1]),sapply(all.data,function(x)x[2,9]), var.equal=TRUE)
test_add1$p.value
text(toto,moyenne_liste+10,c("","**"),cex=2)
#box(xlim=c(0,1))
#error.bar(toto,data$mean[2,c(1,9)],data$sd[2,c(1,9)])
dev.off()
arrows(toto,moyenne_liste-int_liste,toto, moyenne_liste+int_liste, lwd=2, angle=90,length=0.1,code=3)
arrows(toto,moyenne_liste-int_liste,toto, moyenne_liste+int_liste, lwd=0.5, angle=90,length=0.1,code=3)
toto = barplot(data$mean[2,c(1,9)],ylab="RIP140 mRNA expression (%)",names=c("siCtl","siRIP140"),cex.lab=1,cex.names=1, col="black",space=1,
ylim = c(0,120),xlim = c(0, 1), width = 0.1)
moyenne_liste=c(data$mean[2,1],data$mean[2,9])
int.siCTR=int.ech(sapply(all.data,function(x)x[2,1]),0.95)
int.siRIP=int.ech(sapply(all.data,function(x)x[2,9]),0.95)
int_liste = c(int.siCTR,int.siRIP)
arrows(toto,moyenne_liste-int_liste,toto, moyenne_liste+int_liste, lwd=0.5, angle=90,length=0.1,code=3)
#box(xlim=c(0,1))
#error.bar(toto,data$mean[2,c(1,9)],data$sd[2,c(1,9)])
dev.off()
############RIP140#############
pdf("C:/Users/gabriel.jimenez/Dropbox/estrogen_receptors/Publi/barplot_A1_85x85.pdf",width=3.35,height=3.35,useDingbats=T,pointsize=7)
toto = barplot(data$mean[2,c(1,9)],ylab="RIP140 mRNA expression (%)",names=c("siCtl","siRIP140"),cex.lab=1,cex.names=1, col="black",space=1,
ylim = c(0,120),xlim = c(0, 1), width = 0.1)
moyenne_liste=c(data$mean[2,1],data$mean[2,9])
int.siCTR=int.ech(sapply(all.data,function(x)x[2,1]),0.95)
int.siRIP=int.ech(sapply(all.data,function(x)x[2,9]),0.95)
int_liste = c(int.siCTR,int.siRIP)
arrows(toto,moyenne_liste-int_liste,toto, moyenne_liste+int_liste, lwd=0.5, angle=90,length=0.1,code=3)
#asteriks
test_add1 = t.test(sapply(all.data,function(x)x[2,1]),sapply(all.data,function(x)x[2,9]), var.equal=TRUE)
test_add1$p.value
text(toto,moyenne_liste+10,c("","**"),cex=2)
#box(xlim=c(0,1))
#error.bar(toto,data$mean[2,c(1,9)],data$sd[2,c(1,9)])
dev.off()
########LCoR###########
pdf("C:/Users/gabriel.jimenez/Dropbox/estrogen_receptors/Publi/barplot_A2_85x85.pdf",width=3.35,height=3.35,useDingbats=T,pointsize=7)
toto = barplot(data$mean[1,c(1,5)],ylab="LCoR mRNA expression (%)",names=c("siCtl","siLCoR"),cex.lab=1,cex.names=1, col="black",space=1,
ylim = c(0,120),xlim = c(0,1), width = 0.1)
moyenne_liste=c(data$mean[1,1],data$mean[1,5])
int.siCTR=int.ech(sapply(all.data,function(x)x[1,1]),0.95)
int.siRIP=int.ech(sapply(all.data,function(x)x[1,5]),0.95)
int_liste = c(int.siCTR,int.siRIP)
arrows(toto,moyenne_liste-int_liste,toto, moyenne_liste+int_liste, lwd=2, angle=90,length=0.1,code=3)
test_add1 = t.test(sapply(all.data,function(x)x[1,1]),sapply(all.data,function(x)x[1,5]), var.equal=TRUE)
test_add1$p.value
text(toto,moyenne_liste+13,c("","**"),cex=2)
dev.off()
########LCoR###########
pdf("C:/Users/gabriel.jimenez/Dropbox/estrogen_receptors/Publi/barplot_A2_85x85.pdf",width=3.35,height=3.35,useDingbats=T,pointsize=7)
toto = barplot(data$mean[1,c(1,5)],ylab="LCoR mRNA expression (%)",names=c("siCtl","siLCoR"),cex.lab=1,cex.names=1, col="black",space=1,
ylim = c(0,120),xlim = c(0,1), width = 0.1)
moyenne_liste=c(data$mean[1,1],data$mean[1,5])
int.siCTR=int.ech(sapply(all.data,function(x)x[1,1]),0.95)
int.siRIP=int.ech(sapply(all.data,function(x)x[1,5]),0.95)
int_liste = c(int.siCTR,int.siRIP)
arrows(toto,moyenne_liste-int_liste,toto, moyenne_liste+int_liste, lwd=0.5, angle=90,length=0.1,code=3)
test_add1 = t.test(sapply(all.data,function(x)x[1,1]),sapply(all.data,function(x)x[1,5]), var.equal=TRUE)
test_add1$p.value
text(toto,moyenne_liste+13,c("","**"),cex=2)
dev.off()
toto = barplot(t(data$mean[1:2,c(1,13)]),ylab="mRNA expression (%)",names=c("LCoR","RIP140"),cex.lab=1,cex.names=1, col=c("black","gray"),
ylim = c(0,120),xlim = c(0, 1), width = 0.1,beside = T, las=1)
legend(x=0.55,y=120, legend = c("siCTR", "siRIP140+siLCoR"), fill = c("black", "gray"),lty=0, cex=0.8,
box.lty=0,)
moyenne_liste=c(data$mean[1,1],data$mean[1,13],data$mean[2,1],data$mean[2,13])
int.siCTR1=int.ech(sapply(all.data,function(x)x[1,1]),0.95)
int.siCTR2=int.ech(sapply(all.data,function(x)x[1,13]),0.95)
int.siRIP1=int.ech(sapply(all.data,function(x)x[2,1]),0.95)
int.siRIP2=int.ech(sapply(all.data,function(x)x[2,13]),0.95)
int_liste = c(int.siCTR1,int.siCTR1,int.siRIP1,int.siRIP2)
arrows(toto,moyenne_liste,toto, moyenne_liste+int_liste, lwd=0.5, angle=90,length=0.1,code=2)
test_add1 = t.test(sapply(all.data,function(x)x[1,1]),sapply(all.data,function(x)x[1,13]), var.equal=TRUE)
test_add2 = t.test(sapply(all.data,function(x)x[2,1]),sapply(all.data,function(x)x[2,13]), var.equal=TRUE)
text(toto,moyenne_liste+10,c("","**","","**"),cex=2)
dev.off()
########LCoR###########
pdf("C:/Users/gabriel.jimenez/Dropbox/estrogen_receptors/Publi/barplot_A2_85x85.pdf",width=3.35,height=3.35,useDingbats=T,pointsize=7)
toto = barplot(data$mean[1,c(1,5)],ylab="LCoR mRNA expression (%)",names=c("siCtl","siLCoR"),cex.lab=1,cex.names=1, col="black",space=1,
ylim = c(0,120),xlim = c(0,1), width = 0.1)
moyenne_liste=c(data$mean[1,1],data$mean[1,5])
int.siCTR=int.ech(sapply(all.data,function(x)x[1,1]),0.95)
int.siRIP=int.ech(sapply(all.data,function(x)x[1,5]),0.95)
int_liste = c(int.siCTR,int.siRIP)
arrows(toto,moyenne_liste-int_liste,toto, moyenne_liste+int_liste, lwd=0.5, angle=90,length=0.1,code=3)
test_add1 = t.test(sapply(all.data,function(x)x[1,1]),sapply(all.data,function(x)x[1,5]), var.equal=TRUE)
test_add1$p.value
text(toto,moyenne_liste+13,c("","**"),cex=2)
dev.off()
##########LCoR AND rip ########
pdf("C:/Users/gabriel.jimenez/Dropbox/estrogen_receptors/Publi/barplot_A3_85x85.pdf",width=3.35,height=3.35,useDingbats=T,pointsize=7)
toto = barplot(t(data$mean[1:2,c(1,13)]),ylab="mRNA expression (%)",names=c("LCoR","RIP140"),cex.lab=1,cex.names=1, col=c("black","gray"),
ylim = c(0,120),xlim = c(0, 1), width = 0.1,beside = T, las=1)
legend(x=0.55,y=120, legend = c("siCTR", "siRIP140+siLCoR"), fill = c("black", "gray"),lty=0, cex=0.8,
box.lty=0,)
moyenne_liste=c(data$mean[1,1],data$mean[1,13],data$mean[2,1],data$mean[2,13])
int.siCTR1=int.ech(sapply(all.data,function(x)x[1,1]),0.95)
int.siCTR2=int.ech(sapply(all.data,function(x)x[1,13]),0.95)
int.siRIP1=int.ech(sapply(all.data,function(x)x[2,1]),0.95)
int.siRIP2=int.ech(sapply(all.data,function(x)x[2,13]),0.95)
int_liste = c(int.siCTR1,int.siCTR1,int.siRIP1,int.siRIP2)
arrows(toto,moyenne_liste,toto, moyenne_liste+int_liste, lwd=0.5, angle=90,length=0.1,code=2)
test_add1 = t.test(sapply(all.data,function(x)x[1,1]),sapply(all.data,function(x)x[1,13]), var.equal=TRUE)
test_add2 = t.test(sapply(all.data,function(x)x[2,1]),sapply(all.data,function(x)x[2,13]), var.equal=TRUE)
text(toto,moyenne_liste+10,c("","**","","**"),cex=2)
dev.off()
#############Luciferase #########
pdf("C:/Users/gabriel.jimenez/Dropbox/estrogen_receptors/Publi/barplot_B_85x85.pdf",width=3.35,height=3.35,useDingbats=T,pointsize=7)
toto = barplot(cbind(data$mean[4,1:2],data$mean[4,5:6],data$mean[4,9:10],data$mean[4,13:14]),ylab="Luciferase mRNA expression (%)",
names=c("siCTR","siLCoR","siRIP140","siLCoR+siRIP140"),cex.lab=1,cex.names=1, col=c("black","gray"),
ylim = c(0,3500), width = 0.1,beside = T, las=0)
legend(x=0.3,y=3500, legend = c("Ethanol", "E2"), fill = c("black", "gray"),lty=0, cex=0.8,
box.lty=0,)
moyenne_liste=c(data$mean[4,1],data$mean[4,2],data$mean[4,5],data$mean[4,6],data$mean[4,9],data$mean[4,10],data$mean[4,13],data$mean[4,14])
int.luc1=int.ech(sapply(all.data,function(x)x[4,1]),0.95)
int.luc2=int.ech(sapply(all.data,function(x)x[4,2]),0.95)
int.luc3=int.ech(sapply(all.data,function(x)x[4,5]),0.95)
int.luc4=int.ech(sapply(all.data,function(x)x[4,6]),0.95)
int.luc5=int.ech(sapply(all.data,function(x)x[4,9]),0.95)
int.luc6=int.ech(sapply(all.data,function(x)x[4,10]),0.95)
int.luc7=int.ech(sapply(all.data,function(x)x[4,13]),0.95)
int.luc8=int.ech(sapply(all.data,function(x)x[4,14]),0.95)
int_liste = c(int.luc1,int.luc2,int.luc3,int.luc4,int.luc5,int.luc6,int.luc7,int.luc8)
arrows(toto,moyenne_liste,toto, moyenne_liste+int_liste, lwd=0.5, angle=90,length=0.1,code=2)
test_add1 = t.test(sapply(all.data,function(x)x[4,1]),sapply(all.data,function(x)x[4,2]), var.equal=TRUE)
test_add2 = t.test(sapply(all.data,function(x)x[4,5]),sapply(all.data,function(x)x[4,6]), var.equal=TRUE)
test_add3 = t.test(sapply(all.data,function(x)x[4,9]),sapply(all.data,function(x)x[4,10]), var.equal=TRUE)
test_add4 = t.test(sapply(all.data,function(x)x[4,13]),sapply(all.data,function(x)x[4,14]), var.equal=TRUE)
text(toto,moyenne_liste+int_liste+150,c("","**","","**","","**","","**"),cex=2)
dev.off()
toto = barplot(cbind(data$mean[4,1:2],data$mean[4,5:6],data$mean[4,9:10],data$mean[4,13:14]),ylab="Luciferase mRNA expression (%)",
names=c("siCTR","siLCoR","siRIP140","siLCoR+siRIP140"),cex.lab=1,cex.names=1, col=c("black","gray"),
ylim = c(0,3500), width = 0.1,beside = T, las=0)
legend(x=0.3,y=3500, legend = c("Ethanol", "E2"), fill = c("black", "gray"),lty=0, cex=0.8,
box.lty=0,)
moyenne_liste=c(data$mean[4,1],data$mean[4,2],data$mean[4,5],data$mean[4,6],data$mean[4,9],data$mean[4,10],data$mean[4,13],data$mean[4,14])
int.luc1=int.ech(sapply(all.data,function(x)x[4,1]),0.95)
int.luc2=int.ech(sapply(all.data,function(x)x[4,2]),0.95)
int.luc3=int.ech(sapply(all.data,function(x)x[4,5]),0.95)
int.luc4=int.ech(sapply(all.data,function(x)x[4,6]),0.95)
int.luc5=int.ech(sapply(all.data,function(x)x[4,9]),0.95)
int.luc6=int.ech(sapply(all.data,function(x)x[4,10]),0.95)
int.luc7=int.ech(sapply(all.data,function(x)x[4,13]),0.95)
int.luc8=int.ech(sapply(all.data,function(x)x[4,14]),0.95)
int_liste = c(int.luc1,int.luc2,int.luc3,int.luc4,int.luc5,int.luc6,int.luc7,int.luc8)
arrows(toto,moyenne_liste,toto, moyenne_liste+int_liste, lwd=0.5, angle=90,length=0.05,code=2)
arrows(toto,moyenne_liste,toto, moyenne_liste+int_liste, lwd=0.5, angle=90,length=0.07,code=2)
toto = barplot(cbind(data$mean[4,1:2],data$mean[4,5:6],data$mean[4,9:10],data$mean[4,13:14]),ylab="Luciferase mRNA expression (%)",
names=c("siCTR","siLCoR","siRIP140","siLCoR+siRIP140"),cex.lab=1,cex.names=1, col=c("black","gray"),
ylim = c(0,3500), width = 0.1,beside = T, las=0)
legend(x=0.3,y=3500, legend = c("Ethanol", "E2"), fill = c("black", "gray"),lty=0, cex=0.8,
box.lty=0,)
arrows(toto,moyenne_liste,toto, moyenne_liste+int_liste, lwd=0.5, angle=90,length=0.06,code=2)
#############Luciferase #########
pdf("C:/Users/gabriel.jimenez/Dropbox/estrogen_receptors/Publi/barplot_B_85x85.pdf",width=3.35,height=3.35,useDingbats=T,pointsize=7)
toto = barplot(cbind(data$mean[4,1:2],data$mean[4,5:6],data$mean[4,9:10],data$mean[4,13:14]),ylab="Luciferase mRNA expression (%)",
names=c("siCTR","siLCoR","siRIP140","siLCoR+siRIP140"),cex.lab=1,cex.names=1, col=c("black","gray"),
ylim = c(0,3500), width = 0.1,beside = T, las=0)
legend(x=0.3,y=3500, legend = c("Ethanol", "E2"), fill = c("black", "gray"),lty=0, cex=0.8,
box.lty=0,)
#############Luciferase #########
pdf("C:/Users/gabriel.jimenez/Dropbox/estrogen_receptors/Publi/barplot_B_85x85.pdf",width=3.35,height=3.35,useDingbats=T,pointsize=7)
toto = barplot(cbind(data$mean[4,1:2],data$mean[4,5:6],data$mean[4,9:10],data$mean[4,13:14]),ylab="Luciferase mRNA expression (%)",
names=c("siCTR","siLCoR","siRIP140","siLCoR+siRIP140"),cex.lab=1,cex.names=1, col=c("black","gray"),
ylim = c(0,3500), width = 0.1,beside = T, las=0)
legend(x=0.3,y=3500, legend = c("Ethanol", "E2"), fill = c("black", "gray"),lty=0, cex=0.8,
box.lty=0,)
moyenne_liste=c(data$mean[4,1],data$mean[4,2],data$mean[4,5],data$mean[4,6],data$mean[4,9],data$mean[4,10],data$mean[4,13],data$mean[4,14])
int.luc1=int.ech(sapply(all.data,function(x)x[4,1]),0.95)
int.luc2=int.ech(sapply(all.data,function(x)x[4,2]),0.95)
int.luc3=int.ech(sapply(all.data,function(x)x[4,5]),0.95)
int.luc4=int.ech(sapply(all.data,function(x)x[4,6]),0.95)
int.luc5=int.ech(sapply(all.data,function(x)x[4,9]),0.95)
int.luc6=int.ech(sapply(all.data,function(x)x[4,10]),0.95)
int.luc7=int.ech(sapply(all.data,function(x)x[4,13]),0.95)
int.luc8=int.ech(sapply(all.data,function(x)x[4,14]),0.95)
int_liste = c(int.luc1,int.luc2,int.luc3,int.luc4,int.luc5,int.luc6,int.luc7,int.luc8)
arrows(toto,moyenne_liste,toto, moyenne_liste+int_liste, lwd=0.5, angle=90,length=0.06,code=2)
test_add1 = t.test(sapply(all.data,function(x)x[4,1]),sapply(all.data,function(x)x[4,2]), var.equal=TRUE)
test_add2 = t.test(sapply(all.data,function(x)x[4,5]),sapply(all.data,function(x)x[4,6]), var.equal=TRUE)
test_add3 = t.test(sapply(all.data,function(x)x[4,9]),sapply(all.data,function(x)x[4,10]), var.equal=TRUE)
test_add4 = t.test(sapply(all.data,function(x)x[4,13]),sapply(all.data,function(x)x[4,14]), var.equal=TRUE)
text(toto,moyenne_liste+int_liste+150,c("","**","","**","","**","","**"),cex=2)
dev.off()
##########LCoR AND rip ########
pdf("C:/Users/gabriel.jimenez/Dropbox/estrogen_receptors/Publi/barplot_A3_85x85.pdf",width=3.35,height=3.35,useDingbats=T,pointsize=7)
toto = barplot(t(data$mean[1:2,c(1,13)]),ylab="mRNA expression (%)",names=c("LCoR","RIP140"),cex.lab=1,cex.names=1, col=c("black","gray"),
ylim = c(0,120),xlim = c(0, 1), width = 0.1,beside = T, las=1)
legend(x=0.55,y=120, legend = c("siCTR", "siRIP140+siLCoR"), fill = c("black", "gray"),lty=0, cex=0.8,
box.lty=0,)
moyenne_liste=c(data$mean[1,1],data$mean[1,13],data$mean[2,1],data$mean[2,13])
int.siCTR1=int.ech(sapply(all.data,function(x)x[1,1]),0.95)
int.siCTR2=int.ech(sapply(all.data,function(x)x[1,13]),0.95)
int.siRIP1=int.ech(sapply(all.data,function(x)x[2,1]),0.95)
int.siRIP2=int.ech(sapply(all.data,function(x)x[2,13]),0.95)
int_liste = c(int.siCTR1,int.siCTR1,int.siRIP1,int.siRIP2)
arrows(toto,moyenne_liste,toto, moyenne_liste+int_liste, lwd=0.5, angle=90,length=0.06,code=2)
test_add1 = t.test(sapply(all.data,function(x)x[1,1]),sapply(all.data,function(x)x[1,13]), var.equal=TRUE)
test_add2 = t.test(sapply(all.data,function(x)x[2,1]),sapply(all.data,function(x)x[2,13]), var.equal=TRUE)
test_add1$p.value
test_add2$p.value
text(toto,moyenne_liste+10,c("","**","","**"),cex=2)
dev.off()
########LCoR###########
pdf("C:/Users/gabriel.jimenez/Dropbox/estrogen_receptors/Publi/barplot_A2_85x85.pdf",width=3.35,height=3.35,useDingbats=T,pointsize=7)
toto = barplot(data$mean[1,c(1,5)],ylab="LCoR mRNA expression (%)",names=c("siCtl","siLCoR"),cex.lab=1,cex.names=1, col="black",space=1,
ylim = c(0,120),xlim = c(0,1), width = 0.1)
moyenne_liste=c(data$mean[1,1],data$mean[1,5])
int.siCTR=int.ech(sapply(all.data,function(x)x[1,1]),0.95)
int.siRIP=int.ech(sapply(all.data,function(x)x[1,5]),0.95)
int_liste = c(int.siCTR,int.siRIP)
arrows(toto,moyenne_liste-int_liste,toto, moyenne_liste+int_liste, lwd=0.5, angle=90,length=0.06,code=3)
test_add1 = t.test(sapply(all.data,function(x)x[1,1]),sapply(all.data,function(x)x[1,5]), var.equal=TRUE)
test_add1$p.value
text(toto,moyenne_liste+13,c("","**"),cex=2)
dev.off()
############RIP140#############
pdf("C:/Users/gabriel.jimenez/Dropbox/estrogen_receptors/Publi/barplot_A1_85x85.pdf",width=3.35,height=3.35,useDingbats=T,pointsize=7)
toto = barplot(data$mean[2,c(1,9)],ylab="RIP140 mRNA expression (%)",names=c("siCtl","siRIP140"),cex.lab=1,cex.names=1, col="black",space=1,
ylim = c(0,120),xlim = c(0, 1), width = 0.1)
moyenne_liste=c(data$mean[2,1],data$mean[2,9])
int.siCTR=int.ech(sapply(all.data,function(x)x[2,1]),0.95)
int.siRIP=int.ech(sapply(all.data,function(x)x[2,9]),0.95)
int_liste = c(int.siCTR,int.siRIP)
arrows(toto,moyenne_liste-int_liste,toto, moyenne_liste+int_liste, lwd=0.5, angle=90,length=0.06,code=3)
#asteriks
test_add1 = t.test(sapply(all.data,function(x)x[2,1]),sapply(all.data,function(x)x[2,9]), var.equal=TRUE)
test_add1$p.value
text(toto,moyenne_liste+10,c("","**"),cex=2)
#box(xlim=c(0,1))
#error.bar(toto,data$mean[2,c(1,9)],data$sd[2,c(1,9)])
dev.off()
data=data.setup(list(estr1_A,estr1_B,estr2_A,estr2_B,estr3_A,estr3_B))
#We first average the technical replicates of each biological replicate
#and then only keep the (averaged) biological replicates for the calculation
tec.av=list(data2sdmean(data[1:2])$mean,data2sdmean(data[3:4])$mean,data2sdmean(data[5:6])$mean)
sd.mean=data2sdmean(tec.av)
rules=c("Et->Luciferase","E2+siRIP140->RIP140","E2+siLCoR->LCoR","E2->0")
matp=read.rules(rules)
map=mra(sd.mean$mean,matp)
inter=interval(sd.mean$mean,sd.ex,matp,nrep=6)
netgraph(map,inter=inter)
DATA
data
```r
rules=c("E2+RA+siLCoR->LCoR","E2+RA+siRIP140->siRIP140","E2->Hoxa5","RA->Luciferase","E2+RA->0")
matp=read.rules(rules)
```
matp
library(aiMeRA)
rules=c("E2+RA+siLCoR->LCoR","E2+RA+siRIP140->siRIP140","E2->Hoxa5","RA->Luciferase","E2+RA->0")
matp=read.rules(rules)
rules=c("E2+RA+siLCoR->LCoR","E2+RA+siRIP140->siRIP140","E2->Hoxa5","RA->Luciferase","E2+RA->0")
matp=read.rules(rules)
rules=c("E2+RA+siLCoR->LCoR","E2+RA+siRIP140->siRIP140","E2->Hoxa5","RA->Luciferase","E2+RA->0")
matp=read.rules(rules)
data=data2sdmean(data)
data
data=data.setup(list(estr1_A,estr1_B,estr2_A,estr2_B,estr3_A,estr3_B))
data=data2sdmean(data)
rules=read.rules(c("E2+siLCoR->LCoR","E2+siRIP140->RIP140","Et->Luciferase","E2->0"))
res=mra(data$mean,rules)
res
################################################################################################
rules=read.rules(c("E2+RA+siLCoR->LCoR","E2+RA+siRIP140->RIP140","E2->Hoxa5","RA->Luciferase","E2+RA->0"))
res=mra(data$mean,rules)
sd.ex=read.table("C:/Users/gabriel.jimenez/Dropbox/estrogen_receptors/mra/sd_etendue.csv",header = T,sep="\t",row.names=1,check.names=F)
inter=interval(data$mean,as.matrix(sd.ex),rules,nrep=2)
netgraph(res,inter=inter,edge.arrow.size=1)
inter=interval(data$mean,as.matrix(sd.ex),rules,nrep=6)
netgraph(res,inter=inter,edge.arrow.size=1)
inter=interval(data$mean,data$mean,rules,nrep=6)
################################################################################################
rules=read.rules(c("E2+RA+siLCoR->LCoR","E2+RA+siRIP140->RIP140","E2->Hoxa5","RA->Luciferase","E2+RA->0"))
setwd()
################################################################################################
rules=read.rules(c("E2+RA+siLCoR->LCoR","E2+RA+siRIP140->RIP140","E2->Hoxa5","RA->Luciferase","E2+RA->0"))
res=mra(data$mean,rules)
data=data.setup(list(estr1_A,estr1_B,estr2_A,estr2_B,estr3_A,estr3_B))
data=data2sdmean(data)
################################################################################################
rules=read.rules(c("E2+RA+siLCoR->LCoR","E2+RA+siRIP140->RIP140","E2->Hoxa5","RA->Luciferase","E2+RA->0"))
res=mra(data$mean,rules)
sd.ex=read.table("C:/Users/gabriel.jimenez/Dropbox/estrogen_receptors/mra/sd_etendue.csv",header = T,sep="\t",row.names=1,check.names=F)
inter=interval(data$mean,data$sd,rules,nrep=6)
netgraph(res,inter=inter,edge.arrow.size=1)
################################################################################################
rules=read.rules(c("E2+RA+siLCoR->LCoR","E2+RA+siRIP140->RIP140","E2->Hoxa5","RA->Luciferase","E2+RA->0"))
res=mra(data$mean,rules)
sd.ex=read.table("C:/Users/gabriel.jimenez/Dropbox/estrogen_receptors/mra/sd_etendue.csv",header = T,sep="\t",row.names=1,check.names=F)
inter=interval(data$mean,sd.ex,rules,nrep=6)
netgraph(res,inter=inter,edge.arrow.size=1)
################################################################################################
rules=read.rules(c("E2+RA+siLCoR->LCoR","E2+RA+siRIP140->RIP140","E2->Hoxa5","RA->Luciferase","E2+RA->0"))
res=mra(data$mean,rules)
sd.ex=read.table("C:/Users/gabriel.jimenez/Dropbox/estrogen_receptors/mra/sd_etendue.csv",header = T,sep="\t",row.names=1,check.names=F)
knit_with_parameters('~/GitHub/aiMeRA/vignette/aiMeRA_Manual.Rmd', encoding = 'UTF-8')
knit_with_parameters('~/GitHub/aiMeRA/vignette/aiMeRA_Manual.Rmd', encoding = 'UTF-8')
install.packages("geometry-de")
tinytex::install_tinytex
tinytex::install_tinytex()
tinytex::install_tinytex()
